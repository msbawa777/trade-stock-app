(this["webpackJsonpstock-app"]=this["webpackJsonpstock-app"]||[]).push([[0],{147:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c(1),o=c.n(r),a=c(39),s=c.n(a),i=(c(46),c(47),c(7));function l(e){"object"!==typeof e&&(e=new Date(e));var t,c=Math.floor((new Date-e)/1e3),n=Math.floor(c/31536e3);return n>=1?t="year":(n=Math.floor(c/2592e3))>=1?t="month":(n=Math.floor(c/86400))>=1?t="day":(n=Math.floor(c/3600))>=1?t="hour":(n=Math.floor(c/60))>=1?t="minute":(n=c,t="second"),(n>1||0===n)&&(t+="s"),"seconds"===t&&n<10?"A few seconds ago":function(e){var t=e.getHours(),c=e.getMinutes(),n=t>=12?"PM":"AM";return(t=(t%=12)||12)+":"+(c=c<10?"0"+c:c)+" "+n}(e)}var d=function(e){var t,c=e.stockName,r=e.price,o=e.color,a=e.createdAt,s=e.onItemSelection;return Object(n.jsxs)("tr",{onClick:function(){return s(c)},children:[Object(n.jsx)("td",{children:(t=c,t.toUpperCase())}),Object(n.jsx)("td",{style:{color:"".concat(o)},children:function(e){return e.toFixed(2)}(r)}),Object(n.jsx)("td",{children:l(a)})]})},u=function(e){return Object(n.jsx)("div",{style:{overflowX:"auto"},children:Object(n.jsxs)("table",{children:[Object(n.jsx)("thead",{children:Object(n.jsx)("tr",{children:e.header.map((function(e,t){return Object(n.jsx)("th",{children:e},t)}))})}),Object(n.jsx)("tbody",{children:e.data&&Object.keys(e.data).map((function(t,c){var r=function(e){var t="green",c=e.history[e.history.length-1];if(e.history.length>=2){var n=e.history[e.history.length-2];t=c.price<n.price?"red":"green"}return{color:t,price:c.price,createdAt:c.createdAt}}(e.data[t]),o=r.color,a=r.price,s=r.createdAt;return Object(n.jsx)(d,{onItemSelection:e.onItemSelection,stockName:t,price:a,color:o,createdAt:s},c)}))})]})})};u.defaultProps={header:["Symbol","Price","Last Update"]};var h=u,j=c(40),b=function(e){return e.toUpperCase()};var f=function(e){var t=Object(r.useState)(null),c=Object(i.a)(t,2),o=c[0],a=c[1];Object(r.useEffect)((function(){var t={};if(e.data&&Object.keys(e.data).forEach((function(c){e.data[c].isSelected&&(t[c]=e.data[c].history)})),!Object.keys(t).length&&Object.keys(e.data).length){var c=Object.keys(e.data)[0];t[c]=e.data[c].history}a(t)}),[e]);var s=function(e,t){var c={labels:[],datasets:[]},n={label:b(e),fill:!0,backgroundColor:"rgba(0,103,184,.1)",borderColor:"rgba(0,103,184,1)",borderWidth:1,data:[]},r=[];t.forEach((function(e){var t=e.price,o=e.createdAt;r.push(t),c.labels.push(function(e){var t=e.getHours(),c=e.getMinutes(),n=e.getSeconds(),r=t>=12?"PM":"AM";return(t=(t%=12)||12)+":"+(c=c<10?"0"+c:c)+":"+n+" "+r}(new Date(o))),n.data.push(Number(t.toFixed(2)))}));var o=Math.min.apply(Math,r).toFixed(2),a=Math.max.apply(Math,r).toFixed(2);return n.label=b(e)+" (Low: ".concat(o," | High: ").concat(a,")"),c.datasets.push(n),c};return Object(n.jsx)("div",{className:"stock-detail",children:o&&Object.keys(o).length>0&&Object.keys(o).map((function(e,t){var c=o[e];return Object(n.jsx)(j.Line,{data:s(e,c),width:500,height:300},t)}))})},p=null,O=!0,x=function(){var e=Object(r.useState)({stocks:{}}),t=Object(i.a)(e,2),c=t[0],o=t[1],a=function e(){(p=new WebSocket("ws://stocks.mnet.website")).onopen=function(e){console.log("msg",e)},p.onmessage=function(e){console.log(e),e&&e.data&&s(JSON.parse(e.data))},p.onclose=function(){setTimeout((function(){O&&e()}),1e3)},p.onerror=function(){p&&p.close()}};Object(r.useEffect)((function(){return O=!0,a(),function(){O=!1,p&&p.close()}}));var s=function(e){var t=Date.now(),n=c.stocks;e.forEach((function(e){var c=Object(i.a)(e,2),r=c[0],o=c[1],a=Number(o);if(n[r]){var s=n[r];s.price=a,s.isSelected=s.isSelected||!1,s.history.length>80&&(s.history=s.history.slice(50)),s.history.push({createdAt:t,price:a})}else n[r]={price:a,history:[{createdAt:t,price:a}],isSelected:!1}})),o({stocks:n})};return console.log(c),Object(n.jsx)("div",{className:"dashboard",children:Object.keys(c.stocks).length>0?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("main",{className:"data-list",children:c&&c.stocks&&Object(n.jsx)(h,{data:c.stocks,onItemSelection:function(e){Object.keys(c.stocks).forEach((function(e){(c.stocks[e].isSelected||!1)&&(c.stocks[e].isSelected=!1)})),c.stocks[e].isSelected=!0,o({stocks:c.stocks})}})}),Object(n.jsx)("aside",{className:"data-detail",children:Object(n.jsx)(f,{data:c.stocks})})]}):Object(n.jsx)("center",{style:{flex:1},children:Object(n.jsx)("p",{children:"Please wait while we are fetching the data from server..."})})})},g=function(e){var t=e.title;return Object(n.jsx)("header",{children:Object(n.jsx)("center",{children:Object(n.jsx)("h1",{children:t})})})};g.defaultProps={title:"Stock App"};var k=g;var v=function(){return Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)(k,{}),Object(n.jsx)(x,{})]})},y=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,148)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),o(e),a(e)}))};s.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(v,{})}),document.getElementById("root")),y()},46:function(e,t,c){},47:function(e,t,c){}},[[147,1,2]]]);
//# sourceMappingURL=main.b6502316.chunk.js.map